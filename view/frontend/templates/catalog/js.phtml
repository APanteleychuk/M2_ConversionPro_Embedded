<?php $helper = $this->helper('\Celebros\ConversionPro\Helper\Data'); ?>
<script>
function ConversionPro(multiselect, collapse, qty) {
    this.isMultiselect = multiselect;
    this.isCollapsed = collapse;
    this.collapsedQty = qty;
    this.itemSelector = 'li.item';
    this.moreClass = 'more-button';
    this.lessClass = 'less-button';
    this.priceMin = '#input-price-min';
    this.priceMax = '#input-price-max';
    this.moreButton = '<li><a class="filters_more_button" href="#">+ <?php echo __('More') ?></a></li>';
    this.lessButton = '<li><a class="filters_less_button" href="#">- <?php echo __('Less') ?></a></li>';
    here = this;
    this.clickCheckbox = function (el) {
        href = jQuery(el).data('href');
        window.location.href = href;
    };
    this.clickHLink = function (el) {
        checkbox = jQuery(el).prev();
        if (checkbox.prop("checked")) {
            checkbox.prop("checked", false);
        } else {
            checkbox.prop("checked", true);
        }
    };
    this.collapse = function(el) {
        elmnts = jQuery(el).parent().find(here.itemSelector);
        if (jQuery(el).data('collapse') == 'more') {
            elmnts.each( function(i, e) {
                if (jQuery(e).hasClass(here.moreClass)) {
                    jQuery(e).addClass('hided');
                } else {
                    jQuery(e).removeClass('hided');
                }   
            });
        } else {
            elmnts.each( function(i, e) {
                if (i >= here.collapsedQty && !jQuery(e).hasClass(here.moreClass)) {
                    jQuery(e).addClass('hided');
                } else {
                    jQuery(e).removeClass('hided');
                }
            });
        }
    };
    this.applyPrice = function(el) {
        min = parseInt(jQuery(this.priceMin).val());
        min = isNaN(min) ? 0 : min;
        max = parseInt(jQuery(this.priceMax).val());
        max = isNaN(max) ? 0 : max;
        url = jQuery(el).data('url');
        if (min < max) {
            price_value = '_P' + min + '_' + max;
            window.location = url.replace("PRICE_RANGE", price_value);
        }
    };
};
convpro = new ConversionPro(true, true, <?php echo $helper->collapseQty() ?>);
</script>